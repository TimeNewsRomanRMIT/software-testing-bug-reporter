<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>All Submissions</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* tighten up the list a bit */
    #submissions-list .card {
      margin-bottom: 0.5rem;
      padding: 0.75rem;
    }
    #submissions-list p {
      margin: 0.25rem 0;
      font-size: 0.9rem;
    }
    #submissions-list p strong {
      width: 6rem;
      display: inline-block;
    }
  </style>
</head>
<body>

  <div class="container">
    <!-- Hero banner -->
    <header class="hero-banner">
      <div class="logo-container">
        <img src="rmit-logo.png" alt="School Logo" class="logo">
      </div>
    </header>

    <!-- Page title -->
    <div class="card header-card">
      <h1>All Bug Submissions</h1>
    </div>

    <!-- Container for everything -->
    <div id="submissions-list">
      <p>Loading submissions…</p>
    </div>

    <!-- Back link -->
    <div class="buttons">
      <a href="index.html" class="button">← Report Bugs</a>
      <a href="leaderboard.html" class="button">Leaderboard →</a>
    </div>
  </div>

  <script>
    async function loadSubmissions() {
      const res = await fetch('/api/bugs');
      if (!res.ok) {
        document.getElementById('submissions-list')
          .textContent = 'Error loading submissions';
        return;
      }
      const bugs = await res.json();

      const list = document.getElementById('submissions-list');
      list.innerHTML = '';  // clear “Loading…”

      if (bugs.length === 0) {
        list.textContent = 'No submissions yet.';
        return;
      }

      bugs.forEach(bug => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <p><strong>Team:</strong> ${bug.team}</p>
          <p><strong>URL:</strong> ${bug.url}</p>
          <p><strong>Description:</strong> ${bug.description}</p>
          <p><strong>Test Steps:</strong> ${bug.testSteps || '(none)'}</p>
          <p><strong>When:</strong> ${new Date(bug.createdAt).toLocaleString()}</p>
        `;
        if (bug.images && bug.images.length) {
          card.innerHTML += `
            <p><strong>Screenshots:</strong></p>
            <div style="display:flex; gap:8px; flex-wrap:wrap;">
              ${bug.images.map(img =>
                `<a href="${img.path}" target="_blank">
                  <img src="${img.path}" alt="" style="width:120px; height:80px; object-fit:cover; border-radius:6px;">
                </a>`
              ).join('')}
            </div>
          `;
        }
        list.appendChild(card);
      });
    }

    document.addEventListener('DOMContentLoaded', loadSubmissions);
  </script>
</body>
</html>
